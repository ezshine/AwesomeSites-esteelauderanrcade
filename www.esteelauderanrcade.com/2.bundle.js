(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{217:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.COLOR="color",e.DEPTH="depth",e.STENCIL="stencil",e.REFLECT_DEPTH="reflect-depth",e.DEFAULT="color"}(r||(r={}))},219:function(e,t,n){"use strict";var r;!function(e){e[e.OPAQUE=1]="OPAQUE",e[e.BLENDED=2]="BLENDED",e[e.RING_BACK=4]="RING_BACK",e[e.SHADOW_CASTER=1024]="SHADOW_CASTER",e[e.REFLECTED_DEPTH=2048]="REFLECTED_DEPTH",e[e.REFLECTED_COLOR=4096]="REFLECTED_COLOR",e[e.SHADOWS=8192]="SHADOWS",e[e.REFLECTED=6144]="REFLECTED"}(r||(r={})),t.a=r},228:function(e,t,n){"use strict";n.d(t,"a",(function(){return Te}));var r=n(29),s=n(314),i=n.n(s);const a="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):null;function o(e,t,n){return t<=e&&e<=n}var l="undefined"!=typeof TextDecoder?function(e){return a.decode(e)}:function(e){let t="";const n=function(e){let t=0,n=0,r=0,s=128,i=191,a=[],l=e.length;for(var c=0;c<l;++c){var u=e[c];if(0===r){if(o(u,0,127)){a.push(u);continue}if(o(u,194,223)){r=1,t=31&u;continue}if(o(u,224,239)){224===u&&(s=160),237===u&&(i=159),r=2,t=15&u;continue}if(o(u,240,244)){240===u&&(s=144),244===u&&(i=143),r=3,t=7&u;continue}throw new Error("String decoding failed.")}o(u,s,i)?(s=128,i=191,t=t<<6|63&u,++n,n===r&&(a.push(t),t=r=n=0)):(t=r=n=0,s=128,i=191,--c)}return a}(e);for(let e of n)e<=65535?t+=String.fromCharCode(e):(e-=65536,t+=String.fromCharCode(55296+(e>>10),56320+(1023&e)));return t},c=n(8),u=n(95),h=n(2);class p{constructor(){this.gltftype=h.a.ANIMATION,this.duration=0}async parse(e,t){const n=t.samplers.map(t=>e._loadElement(t));this.samplers=await Promise.all(n);for(const e of this.samplers)this.duration=Math.max(e.maxTime);const r=t.channels.map(t=>e._loadElement(t));this.channels=await Promise.all(r)}evaluate(e){for(var t of this.channels)t.evaluate(e)}getChannel(e){return this.channels[e]}getSampler(e){return this.samplers[e]}}var m=n(32);function d(e,t){e.position.set(t),e.invalidate()}function f(e,t){e.rotation.set(t),e.invalidate()}function g(e,t){e.scale.set(t),e.invalidate()}function v(e,t){e.weights.set(t)}class E{constructor(){this.gltftype=h.a.ANIMATION_CHANNEL}async parse(e,t){if(this._active=!1,this.path=t.target.path,this.applyFunction=function(e){switch(e){case m.a.AnimationChannelTargetPath.TRANSLATION:return d;case m.a.AnimationChannelTargetPath.ROTATION:return f;case m.a.AnimationChannelTargetPath.SCALE:return g;case m.a.AnimationChannelTargetPath.WEIGHTS:return v;default:throw new Error("unsupported path "+e)}}(this.path),void 0!==t.target.node){this._active=!0,this.node=await e.getElement(h.a.NODE,t.target.node);let n=1;this.path===m.a.AnimationChannelTargetPath.WEIGHTS&&(n=this.node.mesh.primitives[0].targets.length),e._loadElement(t.elementParent).then(e=>{this.sampler=e.getSampler(t.sampler),this.evaluator=this.sampler.createEvaluator(this.path,n),this.valueHolder=this.evaluator.createElementHolder()})}}evaluate(e){this._active&&(this.evaluator.evaluate(this.valueHolder,e),this.applyFunction(this.node,this.valueHolder))}}var _=n(1);class w{constructor(e){this.frame=0,this.t0=e.getRawScalar(0),this.t1=e.getRawScalar(1),this.inBound=!0,this._fMax=e.count-1}contain(e){return e<this.t0?-1:e>=this.t1?1:0}normalizedFrame(){return Math.min(Math.max(this.frame,0),this._fMax)}}class x{constructor(e,t){this.sampler=e,this.interval=new w(e.input),this.numElements=t}resolveInterval(e){const t=this.interval,n=this.sampler.input,r=n.count,s=t.contain(e);if(0===s)return;let i,a,o,l=!0;if(s>0){i=t.frame+1,a=t.t1;do{i++,l=i<r,o=a,a=l?n.getRawScalar(i):Number.MAX_VALUE}while(a<=e);i--}else{i=t.frame,o=t.t0;do{i--,l=i>=0,a=o,o=l?n.getRawScalar(i):-Number.MAX_VALUE}while(o>e)}t.frame=i,t.t0=o,t.t1=a,t.inBound=l}evaluate(e,t){}}class A extends x{evaluate(e,t){this.resolveInterval(t),this.sampler.output.getValues(e,this.interval.normalizedFrame()*this.numElements,this.numElements)}}function y(e,t,n,r){const s=t.length,i=1-r;for(var a=0;a<s;a++)e[a]=t[a]*i+n[a]*r}function S(e,t,n,r){e[0]=t[0]*(1-r)+n[0]*r}class T extends x{constructor(e,t,n){super(e,n),this.val0=e.output.createElementHolderArray(n),this.val1=e.output.createElementHolderArray(n),this.lerpFunc=function(e,t){switch(e){case m.a.AnimationChannelTargetPath.WEIGHTS:return 1===t?S:y;case m.a.AnimationChannelTargetPath.ROTATION:return _.quat.slerp;case m.a.AnimationChannelTargetPath.SCALE:case m.a.AnimationChannelTargetPath.TRANSLATION:default:return y}}(t,this.val0.length)}evaluate(e,t){this.resolveInterval(t);const n=this.sampler.output,r=this.numElements;if(this.interval.inBound){const{t0:s,t1:i,frame:a}=this.interval,o=(t-s)/(i-s);n.getValues(this.val0,r*a+0,r),n.getValues(this.val1,r*a+r,r),this.lerpFunc(e,this.val0,this.val1,o)}else n.getValues(e,this.interval.normalizedFrame()*r,r)}}class b extends x{constructor(e,t,n){super(e,n),this.val0=e.output.createElementHolderArray(n),this.val1=e.output.createElementHolderArray(n),this.val2=e.output.createElementHolderArray(n),this.val3=e.output.createElementHolderArray(n),this.assumeQuat=t===m.a.AnimationChannelTargetPath.ROTATION}evaluate(e,t){this.resolveInterval(t);const n=this.sampler.output,r=this.numElements;if(this.interval.inBound){const{t0:s,t1:i,frame:a}=this.interval,o=i-s,l=(t-s)/o;n.getValues(this.val0,r*(3*a+1),r),n.getValues(this.val1,r*(3*a+2),r),n.getValues(this.val2,r*(3*a+3),r),n.getValues(this.val3,r*(3*a+4),r),function(e,t,n,r,s,i,a){const o=t*t,l=t*o,c=2*l-3*o+1,u=n*(l-2*o+t),h=3*o-2*l,p=n*(l-o),m=r.length;for(var d=0;d<m;d++)e[d]=c*r[d]+u*s[d]+h*a[d]+p*i[d]}(e,l,o,this.val0,this.val1,this.val2,this.val3),this.assumeQuat&&_.quat.normalize(e,e)}else n.getValues(e,r*(3*this.interval.normalizedFrame()+1),r)}}class C{constructor(e,t,n){this.sampler=e,this.numElements=n,this.interpolator=function(e,t,n){switch(e.interpolation){case m.a.AnimationSamplerInterpolation.STEP:return new A(e,n);case m.a.AnimationSamplerInterpolation.LINEAR:return new T(e,t,n);case m.a.AnimationSamplerInterpolation.CUBICSPLINE:return new b(e,t,n);default:throw new Error("GLTF : Unsupported sampler interpolation "+e.interpolation)}}(e,t,n)}evaluate(e,t){this.interpolator.evaluate(e,t)}createElementHolder(){return this.sampler.output.createElementHolderArray(this.numElements)}}class R{constructor(){this.gltftype=h.a.ANIMATION_SAMPLER,this.minTime=0,this.maxTime=0}async parse(e,t){this.input=await e.getElement(h.a.ACCESSOR,t.input),this.output=await e.getElement(h.a.ACCESSOR,t.output),this.interpolation=t.interpolation||m.a.AnimationSamplerInterpolation.LINEAR,this.minTime=this.input.getRawScalar(0),this.maxTime=this.input.getRawScalar(this.input.count-1)}createEvaluator(e,t){return new C(this,e,t)}}var P,I=n(71);!function(e){e.float="float",e.vec2="vec2",e.vec3="vec3",e.vec4="vec4",e.mat2="mat2",e.mat3="mat3",e.mat4="mat4"}(P||(P={}));const D=e=>Math.max(e/127,-1),M=e=>e/255,N=e=>Math.max(e/32767,-1),O=e=>e/65535,F=e=>e,U=e=>e;function B(e){switch(e){case m.a.AccessorComponentType.BYTE:return Int8Array;case m.a.AccessorComponentType.UNSIGNED_BYTE:return Uint8Array;case m.a.AccessorComponentType.SHORT:return Int16Array;case m.a.AccessorComponentType.UNSIGNED_SHORT:return Uint16Array;case m.a.AccessorComponentType.UNSIGNED_INT:return Uint32Array;case m.a.AccessorComponentType.FLOAT:return Float32Array}}class V{constructor(){this.normalized=!1,this.byteOffset=0,this.count=0,this._stride=0,this._strideElem=0}get numComps(){return function(e){switch(e){case m.a.AccessorType.SCALAR:return 1;case m.a.AccessorType.VEC2:return 2;case m.a.AccessorType.VEC3:return 3;case m.a.AccessorType.VEC4:case m.a.AccessorType.MAT2:return 4;case m.a.AccessorType.MAT3:return 9;case m.a.AccessorType.MAT4:return 16}}(this.type)}get bytesPerElem(){return B(this.componentType).BYTES_PER_ELEMENT}get glslType(){return function(e){switch(e){case m.a.AccessorType.SCALAR:return P.float;case m.a.AccessorType.VEC2:return P.vec2;case m.a.AccessorType.VEC3:return P.vec3;case m.a.AccessorType.VEC4:return P.vec4;case m.a.AccessorType.MAT2:return P.mat2;case m.a.AccessorType.MAT3:return P.mat3;case m.a.AccessorType.MAT4:return P.mat4}}(this.type)}*[Symbol.iterator](){const e=this.createElementHolder();for(let t=0;t<this.count;t++)this.getValue(e,t),yield e}createElementHolder(e=this.normalized){return e?new Float32Array(this.numComps):new(B(this.componentType))(this.numComps)}createElementHolderArray(e,t=this.normalized){return t?new Float32Array(this.numComps*e):new(B(this.componentType))(this.numComps*e)}getScalar(e,t=this.normalized){let n;return n=null!==this.sparse?this.sparse.getRawScalar(e):this.getRawScalar(e),t&&(n=this._normalizeFunc(n)),n}getRawScalar(e){const t=this._strideElem*e;return this._array[t]}getValue(e,t,n=this.normalized){const r=n?this._valueHolder:e;null!==this.sparse?this.sparse.getRawValue(r,t):this.getRawValue(r,t),n&&this._normalize(e,r)}getValues(e,t,n){if(null!==this.sparse)throw new Error("Cant call getValues in sparsed accessor");this.getRawValues(e,t,n),this.normalized&&this._normalize(e,e)}getRawValue(e,t){const n=this._strideElem*t,r=this.numComps;for(var s=0;s<r;s++)e[s]=this._array[s+n]}getRawValues(e,t,n){const r=this.numComps;for(let i=0;i<n;i++){const n=i*r,a=this._strideElem*(t+i);for(var s=0;s<r;s++)e[n+s]=this._array[s+a]}}_normalize(e,t){const n=this._normalizeFunc,r=this.numComps;for(var s=0;s<r;s++)e[s]=n(t[s])}}class L extends V{constructor(){super(...arguments),this.gltftype=h.a.ACCESSOR}async parse(e,t){const{byteOffset:n=0,normalized:r=!1}=t;if(this.normalized=r,this.byteOffset=n,this.componentType=t.componentType,this.count=t.count,this.type=t.type,this.max=t.max,this.min=t.min,void 0!==t.bufferView){this.bufferView=await e.getElement(h.a.BUFFERVIEW,t.bufferView);const n=B(this.componentType);0===this.bufferView.byteStride?(this._stride=this.numComps*this.bytesPerElem,this._strideElem=this.numComps):(this._stride=this.bufferView.byteStride,this._strideElem=this._stride/n.BYTES_PER_ELEMENT,I.a.isTrue(this._strideElem===Math.round(this._strideElem))),this._array=new n(this.bufferView.buffer._bytes,this.byteOffset+this.bufferView.getByteOffset(),this.count*this._strideElem)}else this.bufferView=null,this._stride=0,this._strideElem=0,this._array=this.createElementHolder();return this.sparse=null,void 0!==t.sparse&&e._loadElement(t.sparse).then(e=>this.sparse=e),this._valueHolder=this.createElementHolder(),this._normalizeFunc=function(e){switch(e){case m.a.AccessorComponentType.BYTE:return D;case m.a.AccessorComponentType.UNSIGNED_BYTE:return M;case m.a.AccessorComponentType.SHORT:return N;case m.a.AccessorComponentType.UNSIGNED_SHORT:return O;case m.a.AccessorComponentType.UNSIGNED_INT:return F;case m.a.AccessorComponentType.FLOAT:return U}}(this.componentType),Promise.resolve()}}var z=n(82),H=n(99);class G{constructor(){this.gltftype=h.a.CAMERA}parse(e,t){switch(this.type=t.type,this.type){case m.a.CameraType.PERSPECTIVE:this.projectionData=t.perspective,this.lens=this.createPerpective(this.projectionData);break;case m.a.CameraType.ORTHOGRAPHIC:this.projectionData=t.orthographic,this.lens=this.createOrtho(this.projectionData);break;default:throw new Error("Camera - unsupported type "+this.type)}return Promise.resolve()}createPerpective(e){var t,n;const r=new z.a;return r.near=e.znear,r.far=null!==(t=e.zfar)&&void 0!==t?t:100,r.setVerticalFov(e.yfov),r.aspect=null!==(n=e.aspectRatio)&&void 0!==n?n:1,r}createOrtho(e){const t=new H.a;return t.near=e.znear,t.far=e.zfar,t._xMin=-e.xmag,t._xMax=e.xmag,t._yMin=-e.ymag,t._yMax=e.ymag,t}}var W=n(49);class X{constructor(){this.gltftype=h.a.MESH}async parse(e,t){const n=t.primitives.map(t=>e._loadElement(t));this.primitives=await Promise.all(n),t.weights&&(this.weights=new Float32Array(t.weights))}}var k=n(3),j=n(79);class J{constructor(){this._sampler=null}createSampler(e){if(null===this._sampler){const t=c.a.getSemantics().getAttributeName("TEXCOORD_"+this.texCoord);this._sampler=new k.a(`tex_${null!==name&&void 0!==name?name:""}${e}`,j.b.create(t)),this.texture.glTexturePromise.then(e=>this._sampler.set(e))}return this._sampler}async parse(e,t){var n;this.texture=await e.getElement(h.a.TEXTURE,t.index),this.texCoord=null!==(n=t.texCoord)&&void 0!==n?n:0}}class $ extends J{constructor(){super(...arguments),this.gltftype=h.a.TEXTURE_INFO}}class K extends J{constructor(){super(...arguments),this.gltftype=h.a.NORMAL_TEXTURE_INFO}async parse(e,t){var n;await super.parse(e,t),this.scale=null!==(n=t.scale)&&void 0!==n?n:1}}class Y extends J{constructor(){super(...arguments),this.gltftype=h.a.OCCLUSION_TEXTURE_INFO}async parse(e,t){var n;await super.parse(e,t),this.strength=null!==(n=t.strength)&&void 0!==n?n:1}}var q=n(101),Q=n(100);class Z{constructor(){this.gltftype=h.a.SAMPLER}parse(e,t){var n,r;return this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.wrapS=null!==(n=t.wrapS)&&void 0!==n?n:10497,this.wrapT=null!==(r=t.wrapT)&&void 0!==r?r:10497,Promise.resolve()}}class ee{constructor(){this.gltftype=h.a.SCENE}async parse(e,t){if(void 0!==t.nodes){const n=t.nodes.map(t=>e.getElement(h.a.NODE,t));this.nodes=await Promise.all(n)}else this.nodes=[]}updateNodes(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].updateWorldMatrix()}}const te=_.mat4.create();class ne{constructor(){this.gltftype=h.a.SKIN}async parse(e,t){const n=t.joints.map(t=>e.getElement(h.a.NODE,t));if(this.joints=await Promise.all(n),this.inverseBindMatrices=this.joints.map(_.mat4.create),void 0!==t.inverseBindMatrices){const n=await e.getElement(h.a.ACCESSOR,t.inverseBindMatrices);this.inverseBindMatrices.forEach((e,t)=>n.getValue(e,t))}void 0!==t.skeleton&&(this.skeletonRoot=await e.getElement(h.a.NODE,t.skeleton))}computeJoints(e,t){if(t.length!==this.joints.length)throw new Error("Skin.computeJoints(), jointMatrices size must match joints size");_.mat4.invert(te,e._wmatrix);for(let e=0;e<this.joints.length;e++){const n=this.joints[e],r=this.inverseBindMatrices[e],s=t[e];_.mat4.mul(s,n._wmatrix,r),_.mat4.mul(s,te,s)}}}var re=n(36);class se{constructor(){this.resolve=e=>{this._resolve(e)},this.reject=e=>{this._reject(e)},this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}}class ie{constructor(){this.gltftype=h.a.TEXTURE,this._glTextureDeferred=new se}get glTexturePromise(){return this._glTextureDeferred.promise}async parse(e,t){void 0!==t.sampler&&(this.sampler=await e.getElement(h.a.SAMPLER,t.sampler)),void 0!==t.source&&(this.source=await e.getElement(h.a.IMAGE,t.source))}async allocateGl(e){var t,n;let r=e.RGBA;this.source.mimeType===m.a.ImageMimeType.JPEG&&(r=e.RGBA);let s=e.LINEAR,i=e.LINEAR,a=e.REPEAT,o=e.REPEAT;this.sampler&&(s=null!==(t=this.sampler.minFilter)&&void 0!==t?t:e.LINEAR,i=null!==(n=this.sampler.magFilter)&&void 0!==n?n:e.LINEAR,a=this.sampler.wrapS,o=this.sampler.wrapT),this.glTexture=new re.a(e,r,e.UNSIGNED_BYTE),await this.source.setupTexture(this.glTexture,a,o,s,i),this.glTexture.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,o),e.bindTexture(e.TEXTURE_2D,null),this._glTextureDeferred.resolve(this.glTexture)}}var ae=n(268),oe=n(104);class le{constructor(){this.gltftype=h.a.ASSET}parse(e,t){return this.version=t.version,this.copyright=t.copyright,this.generator=t.generator,this.minVersion=t.minVersion,Promise.resolve()}}class ce{constructor(){this.gltftype=h.a.BUFFER}async parse(e,t){this.byteLength=t.byteLength,this.uri=t.uri,this._byteOffset=0,this._bytes=await e.loadBufferUri(t.uri),I.a.isTrue(null!==this._bytes)}}class ue{constructor(){this.gltftype=h.a.BUFFERVIEW,this.byteOffset=0,this.byteLength=0,this.byteStride=0,this.target=0,this.glBuffer=null,this.glBufferTarget=0}async parse(e,t){const{byteLength:n,byteOffset:r=0,byteStride:s=0,target:i=0}=t;this.byteLength=n,this.byteOffset=r,this.byteStride=s,this.target=i,this.buffer=await e.getElement(h.a.BUFFER,t.buffer)}getByteOffset(){return this.byteOffset+this.buffer._byteOffset}getWebGLBuffer(e,t){if(0!==this.target&&this.target!==t)throw new Error(`BufferView's target ${this.target} doesn't match infered one ${t}`);if(null!==this.glBuffer){if(this.glBufferTarget!==t)throw new Error("WebglBuffers with different target requested on BufferView")}else{const n=new Uint8Array(this.buffer._bytes,this.getByteOffset(),this.byteLength);this.glBufferTarget=t,this.glBuffer=e.createBuffer(),e.bindBuffer(t,this.glBuffer),e.bufferData(t,n,e.STATIC_DRAW),e.bindBuffer(t,null)}return this.glBuffer}}class he{constructor(){this.gltftype=h.a.ACCESSOR_SPARSE}async parse(e,t,...n){this.accessor=await e.getElement(h.a.ACCESSOR,t.elementParent.elementIndex),this.indices=await e._loadElement(t.indices),this.values=await e._loadElement(t.values);const r=this.indicesSet=new Set,s=this.indicesMap=new Map,i=this.indices,a=i.count;for(var o=0;o<a;o++){var l=i.getScalar(o);r.add(l),s.set(l,o)}}getRawValue(e,t){this.indicesSet.has(t)?this.values.getRawValue(e,this.indicesMap.get(t)):this.accessor.getRawValue(e,t)}getRawScalar(e){return this.indicesSet.has(e)?this.values.getRawScalar(this.indicesMap.get(e)):this.accessor.getRawScalar(e)}}class pe extends V{constructor(){super(...arguments),this.gltftype=h.a.ACCESSOR_SPARSE_INDICES}async parse(e,t){var n;const r=t.elementParent;this.normalized=!1,this.byteOffset=null!==(n=t.byteOffset)&&void 0!==n?n:0,this.componentType=t.componentType,this.count=r.count,this.type=m.a.AccessorType.SCALAR,this.sparse=null,this.bufferView=await e.getElement(h.a.BUFFERVIEW,t.bufferView);const s=B(this.componentType);return 0===this.bufferView.byteStride?(this._stride=this.numComps*this.bytesPerElem,this._strideElem=this.numComps):(this._stride=this.bufferView.byteStride,this._strideElem=this._stride/s.BYTES_PER_ELEMENT,I.a.isTrue(this._strideElem===Math.round(this._strideElem))),this._array=new s(this.bufferView.buffer._bytes,this.byteOffset+this.bufferView.getByteOffset(),this.count*this._strideElem),this._valueHolder=this.createElementHolder(),Promise.resolve()}}class me extends V{constructor(){super(...arguments),this.gltftype=h.a.ACCESSOR_SPARSE_VALUES}async parse(e,t){var n,r;const s=t.elementParent,i=s.elementParent;this.byteOffset=null!==(n=t.byteOffset)&&void 0!==n?n:0,this.count=s.count,this.normalized=null!==(r=i.normalized)&&void 0!==r&&r,this.componentType=i.componentType,this.type=i.type,this.sparse=null,this.bufferView=await e.getElement(h.a.BUFFERVIEW,t.bufferView);const a=B(this.componentType);return 0===this.bufferView.byteStride?(this._stride=this.numComps*this.bytesPerElem,this._strideElem=this.numComps):(this._stride=this.bufferView.byteStride,this._strideElem=this._stride/a.BYTES_PER_ELEMENT,I.a.isTrue(this._strideElem===Math.round(this._strideElem))),this._array=new a(this.bufferView.buffer._bytes,this.byteOffset+this.bufferView.getByteOffset(),this.count*this._strideElem),this._valueHolder=this.createElementHolder(),Promise.resolve()}}class de{constructor(e){this.name="default",this.priority=0,this.loader=e}acceptElement(e,t){return null}loadElement(e){switch(e.gltftype){case h.a.ACCESSOR:return this.createAccessor(e);case h.a.ACCESSOR_SPARSE:return this.createAccessorSparse(e);case h.a.ACCESSOR_SPARSE_INDICES:return this.createAccessorSparseIndices(e);case h.a.ACCESSOR_SPARSE_VALUES:return this.createAccessorSparseValues(e);case h.a.ANIMATION:return this.createAnimation(e);case h.a.ANIMATION_SAMPLER:return this.createAnimationSampler(e);case h.a.ANIMATION_CHANNEL:return this.createAnimationChannel(e);case h.a.ASSET:return this.createAsset(e);case h.a.BUFFER:return this.createBuffer(e);case h.a.BUFFERVIEW:return this.createBufferview(e);case h.a.CAMERA:return this.createCamera(e);case h.a.IMAGE:return this.createImage(e);case h.a.MATERIAL:return this.createMaterial(e);case h.a.MESH:return this.createMesh(e);case h.a.NODE:return this.createNode(e);case h.a.NORMAL_TEXTURE_INFO:return this.createNormalTextureInfo(e);case h.a.OCCLUSION_TEXTURE_INFO:return this.createOcclusionTextureInfo(e);case h.a.PRIMITIVE:return this.createPrimitive(e);case h.a.SAMPLER:return this.createSampler(e);case h.a.SCENE:return this.createScene(e);case h.a.SKIN:return this.createSkin(e);case h.a.TEXTURE:return this.createTexture(e);case h.a.TEXTURE_INFO:return this.createTextureInfo(e)}}async createAccessor(e){const t=new L;return await t.parse(this.loader,e),t}async createAccessorSparse(e){const t=new he;return await t.parse(this.loader,e),t}async createAccessorSparseIndices(e){const t=new pe;return await t.parse(this.loader,e),t}async createAccessorSparseValues(e){const t=new me;return await t.parse(this.loader,e),t}async createAsset(e){const t=new le;return await t.parse(this.loader,e),t}async createBuffer(e){const t=new ce;return await t.parse(this.loader,e),t}async createBufferview(e){const t=new ue;return await t.parse(this.loader,e),t}async createAnimationChannel(e){const t=new E;return await t.parse(this.loader,e),t}async createAnimationSampler(e){const t=new R;return await t.parse(this.loader,e),t}async createAnimation(e){const t=new p;return await t.parse(this.loader,e),t}async createCamera(e){const t=new G;return await t.parse(this.loader,e),t}async createImage(e){const t=new oe.a;return await t.parse(this.loader,e),t}async createMaterial(e){const t=new W.a;return await t.parse(this.loader,e),t}async createMesh(e){const t=new X;return await t.parse(this.loader,e),t}async createNode(e){const t=new ae.a;return await t.parse(this.loader,e),t}async createNormalTextureInfo(e){const t=new K;return await t.parse(this.loader,e),t}async createOcclusionTextureInfo(e){const t=new Y;return await t.parse(this.loader,e),t}async createPbrMetallicRoughness(e){const t=new q.a;return await t.parse(this.loader,e),t}async createPrimitive(e){const t=new Q.a;return await t.parse(this.loader,e),t}async createSampler(e){const t=new Z;return await t.parse(this.loader,e),t}async createScene(e){const t=new ee;return await t.parse(this.loader,e),t}async createSkin(e){const t=new ne;return await t.parse(this.loader,e),t}async createTexture(e){const t=new ie;return await t.parse(this.loader,e),t}async createTextureInfo(e){const t=new $;return await t.parse(this.loader,e),t}}const fe=new class{constructor(){this.name="default"}createInstance(e){return new de(e)}};c.a.addExtension(fe);var ge=n(318);let ve=0;const Ee={gltftype:h.a.MATERIAL,elementIndex:-1,elementParent:null,uuid:"_default_mat_",name:"default"};class _e{constructor(e,t){this.data=e,this.promise=t}}class we{constructor(e,t,n={}){var r;this._elements=new Map,this._pendingElements=[],this._byType=new Map,this._propertyMaps=new Map,this.unpack=e=>{if(1179937895===new Uint32Array(e,0,1)[0])this.unpackGlb(e);else{const t=this.gltfIO.decodeUTF8(e);this._data=JSON.parse(t),this.prepareGltfDatas(this._data)}return Promise.resolve(!0)},this.loadBufferUri=e=>{if(void 0===e)return Promise.resolve(this._glbData);const t=this.gltfIO.resolvePath(e,this._baseUrl);return this.gltfIO.loadBinaryResource(t,this.abortSignal)},this.parseAll=async()=>{this._extensions.validate(this._data.extensionsUsed,this._data.extensionsRequired);const e=await this._loadElement(this._data.asset);"2.0"!=e.version&&console.warn(`Gltf version should be "2.0" found "${e.version}"`),await this._loadElements(this._data.nodes),await this._loadElements(this._data.animations),await this.resolveElements()},this.yieldGltf=()=>Promise.resolve(this.gltf),this.gltfIO=e,this._url=t,this._baseUrl=n.baseurl,this.abortSignal=null!==(r=n.abortSignal)&&void 0!==r?r:ge.a.none,void 0===this._baseUrl&&([this._baseUrl,this._url]=e.resolveBaseDir(this._url)),this.gltf=new c.a,this._data=null,this._extensions=new u.a,c.a.getExtensionsRegistry().setupExtensions(this,n.extensions)}load(){return this.gltfIO.loadBinaryResource(this.gltfIO.resolvePath(this._url,this._baseUrl),this.abortSignal).then(this.unpack).then(this.parseAll).then(this.yieldGltf)}unpackGlb(e){const[,t,,n,r]=new Uint32Array(e,0,5);if(2!==t)throw new Error("Binary glTF version is not 2");if(1313821514!==r)throw new Error("Binary glTF scene format is not JSON");const s=this.gltfIO.decodeUTF8(e,20,n);this._glbData=e.slice(20+n+8),this._data=JSON.parse(s),this.prepareGltfDatas(this._data)}resolveUri(e){return this.gltfIO.resolvePath(e,this._baseUrl)}parseCommonGltfProperty(e,t){void 0===t.name&&(t.name=e.name),void 0===t.extras&&(t.extras=e.extras)}async _createElement(e){let t=await this._createElementInstance(e);return this.parseCommonGltfProperty(e,t),this._extensionsAccept(e,t)}_createElementInstance(e){const t=this._extensions._list;for(const n of t){const t=n.loadElement(e);if(void 0===t)throw new Error("extension should not return undefined");if(null!==t)return t}throw new Error("Unhandled type")}async _extensionsAccept(e,t){const n=this._extensions._list;let r;for(const s of n)r=s.acceptElement(e,t),null!==r&&(t=await r);return t}_loadElement(e){let t=this._elements.get(e.uuid);if(void 0===t){t=this._createElement(e);const n=new _e(e,t);this._pendingElements.push(n),this._elements.set(e.uuid,t)}return t}loadDefaultMaterial(){return this._loadElement(Ee)}_getElementHolder(e){let t=this._byType.get(e);return void 0===t&&(t=[],this._byType.set(e,t)),t}getElement(e,t){const n=this._getElementHolder(e);if(void 0!==n[t])return n[t];const r=this._propertyMaps.get(e)[t];return this._loadElement(r)}_loadElements(e){if(void 0!==e){const t=e.map(e=>this._loadElement(e));return Promise.all(t)}}async resolveElements(){for(;this._pendingElements.length>0;){const e=this._pendingElements.splice(0,this._pendingElements.length),t=await Promise.all(e.map(e=>e.promise));for(let n=0;n<e.length;n++){const r=t[n];I.a.isDefined(r.gltftype),this.gltf.addElement(t[n],e[n].data.elementIndex)}}}prepareGltfDatas(e){if(this.prepareGltfRootProperties(e.accessors,h.a.ACCESSOR,null),this.prepareGltfRootProperties(e.animations,h.a.ANIMATION,null),this.prepareGltfRootProperties([e.asset],h.a.ASSET,null),this.prepareGltfRootProperties(e.buffers,h.a.BUFFER,null),this.prepareGltfRootProperties(e.bufferViews,h.a.BUFFERVIEW,null),this.prepareGltfRootProperties(e.cameras,h.a.CAMERA,null),this.prepareGltfRootProperties(e.images,h.a.IMAGE,null),this.prepareGltfRootProperties(e.materials,h.a.MATERIAL,null),this.prepareGltfRootProperties(e.meshes,h.a.MESH,null),this.prepareGltfRootProperties(e.nodes,h.a.NODE,null),this.prepareGltfRootProperties(e.samplers,h.a.SAMPLER,null),this.prepareGltfRootProperties(e.scenes,h.a.SCENE,null),this.prepareGltfRootProperties(e.skins,h.a.SKIN,null),this.prepareGltfRootProperties(e.textures,h.a.TEXTURE,null),void 0!==e.animations)for(const t of e.animations)this.prepareGltfProperties(t.samplers,h.a.ANIMATION_SAMPLER,t),this.prepareGltfProperties(t.channels,h.a.ANIMATION_CHANNEL,t);if(void 0!==e.materials)for(const t of e.materials)this.prepareGltfProperty(t.normalTexture,h.a.NORMAL_TEXTURE_INFO,-1,t),this.prepareGltfProperty(t.occlusionTexture,h.a.OCCLUSION_TEXTURE_INFO,-1,t),this.prepareGltfProperty(t.emissiveTexture,h.a.TEXTURE_INFO,-1,t),void 0!==t.pbrMetallicRoughness&&(this.prepareGltfProperty(t.pbrMetallicRoughness.baseColorTexture,h.a.TEXTURE_INFO,-1,t),this.prepareGltfProperty(t.pbrMetallicRoughness.metallicRoughnessTexture,h.a.TEXTURE_INFO,-1,t));if(void 0!==e.meshes)for(const t of e.meshes)this.prepareGltfProperties(t.primitives,h.a.PRIMITIVE,t);if(void 0!==e.accessors)for(const t of e.accessors)this.prepareGltfProperty(t.sparse,h.a.ACCESSOR_SPARSE,-1,t),void 0!==t.sparse&&(this.prepareGltfProperty(t.sparse.indices,h.a.ACCESSOR_SPARSE_INDICES,-1,t.sparse),this.prepareGltfProperty(t.sparse.values,h.a.ACCESSOR_SPARSE_VALUES,-1,t.sparse))}prepareGltfProperties(e,t,n){if(void 0!==e)for(let r=0;r<e.length;r++){const s=e[r];this.prepareGltfProperty(s,t,r,n)}}prepareGltfRootProperties(e,t,n){if(void 0!==e){this._propertyMaps.set(t,e);for(let r=0;r<e.length;r++){const s=e[r];this.prepareGltfProperty(s,t,r,n)}}}prepareGltfProperty(e,t,n,r){void 0!==e&&(e.gltftype=t,e.uuid=ve+++"",e.elementIndex=n,e.elementParent=r)}}var xe=n(91);const Ae=async function(){if(void 0===window.createImageBitmap)return!1;const e=await fetch("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="),t=await e.blob();try{await window.createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}catch(e){return!1}return!0}();const ye=new class{isDataURI(e){return 0===e.indexOf("data:")}decodeDataURI(e){if(0!==e.indexOf("data:"))throw new Error("invalid dataURI");var t=e.substr(e.indexOf(",")+1);return i.a.toByteArray(t).buffer}resolveBaseDir(e){return function(e){const t=e.lastIndexOf("/");return[e.substr(0,t),e.substr(t+1)]}(e)}resolvePath(e,t){return void 0===t||this.isDataURI(e)?e:t+"/"+e}decodeUTF8(e,t=0,n){return void 0===n&&(n=e.byteLength-t),l(new Uint8Array(e,t,n))}async loadResource(e,t=ge.a.none){const n=Object(xe.b)(t);return(await fetch(e,{signal:n})).text()}async loadBinaryResource(e,t=ge.a.none){if(this.isDataURI(e))return this.decodeDataURI(e);const n=Object(xe.b)(t);return(await fetch(e,{signal:n})).arrayBuffer()}async loadImageBuffer(e,t,n=ge.a.none){const r=new Blob([e],{type:t});return this.loadImageBlob(r,n)}async loadImage(e,t=ge.a.none){const n=Object(xe.b)(t),r=await fetch(e,{signal:n}),s=await r.blob();return this.loadImageBlob(s,t)}async loadImageBlob(e,t){let n;if(await Ae)n=createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"});else{const t=new window.Image,r=URL.createObjectURL(e);n=new Promise((e,n)=>{t.onload=e,t.onerror=n,t.src=r}).finally(()=>URL.revokeObjectURL(r)).then(()=>t)}return Object(xe.a)(n,t)}writeResource(e,t){throw new Error("Method not implemented.")}writeBinaryResource(e,t){throw new Error("Method not implemented.")}};var Se=new class{constructor(e){this._ioImpl=e}loadGltf(e,t={}){return new we(this._ioImpl,e,t).load()}}(ye);class Te extends r.a{constructor(e,t,n,r={}){super(e,n),this.request=t,this.opts=r}get value(){return this.gltf}async load(){this.gltf=await Se.loadGltf(this.request,this.opts),await this.gltf.allocateGl(this.group.gl),this.resolve(this.gltf)}unload(){this.gltf=null}}},241:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(14);class s extends r.a{constructor(e="default",t,n=r.a.default){super(e,n),this.gl=t}}},242:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this.scene=e,this.camera=t,this._current=null}setControler(e){var t;null===(t=this._current)||void 0===t||t.stop(),this._current=e,null==e||e.start(this.camera)}preRender(){this._current&&this._current.update(this.scene.dt)}}},243:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n(222),s=n(77),i=n(86),a=n(76),o=n(15),l=n(345),c=n.n(l),u=n(346),h=n.n(u),p=n(347),m=n.n(p),d=n(348),f=n.n(d),g=n(349),v=n.n(g),E=n(350),_=n.n(E),w=n(351),x=n.n(w);class A extends r.b{constructor(){super(),this._downFbos=[],this._upFbos=[],this.color=new Float32Array([1,1,1]),this._bloomParams=new Float32Array(4),this.scatter=.7,this.clamp=100,this.threshold=.9}set scatter(e){this._bloomParams[0]=e}set clamp(e){this._bloomParams[1]=e}set threshold(e){this._bloomParams[2]=e,this._bloomParams[3]=.5*e}get scatter(){return this._bloomParams[0]}get clamp(){return this._bloomParams[1]}get threshold(){return this._bloomParams[2]}_buildPrograms(){throw new Error("Method not implemented.")}init(){if(this._isInit)return;this._isInit=!0;const e=this.post.gl,t=i.a.getInstance(e),n=[t.RGB16F,t.RGBA16F,t.RGB32F,t.RGBA32F,t.RGB8];this.hdrFormat=t.getRenderableFormat(n);var r="#version "+(Object(o.a)(e)?"300 es":"100");this.blurHPrg=new a.a(e),this.blurHPrg.compile(x()(),m()(),r),this.blurVPrg=new a.a(e),this.blurVPrg.compile(x()(),f()(),r),this.prefilterPrg=new a.a(e),this.prefilterPrg.compile(x()(),v()(),r),this.upsmplPrg=new a.a(e),this.upsmplPrg.compile(x()(),_()(),r)}release(){}genCode(e,t){e.push(c()()),t.push(h()())}setupProgram(e){const t=this.color;e.uBloomColor(t[0],t[1],t[2]),e.tBloom(this._upFbos[0].getColorTexture())}resize(e,t){this.releaseFbos();let n=this.post.renderWidth>>1,r=this.post.renderHeight>>1;const s=Math.max(n,r),i=Math.floor(Math.log2(s)-1),a=Math.max(1,Math.min(12,i));this._downFbos[0]=this.createFbo(n,r),this._upFbos[0]=this.createFbo(n,r);for(let e=1;e<a;e++)n=Math.max(1,n>>1),r=Math.max(1,r>>1),this._downFbos[e]=this.createFbo(n,r),this._upFbos[e]=this.createFbo(n,r)}preRender(){let e=this.post.renderWidth>>1,t=this.post.renderHeight>>1;const n=Math.max(e,t),r=Math.floor(Math.log2(n)-1),s=Math.max(1,Math.min(12,r));let i=this._downFbos[0];this.prefilterPrg.use(),this.prefilterPrg.tInput(this.post.mainColor),this.prefilterPrg.uParams(this._bloomParams),i.bind(),i.defaultViewport(),this.post.fillScreen(this.prefilterPrg);for(let e=1;e<s;e++){const t=this._downFbos[e],n=this._upFbos[e];this.blurHPass(i,n),this.blurVPass(n,t),i=t}this.upsmplPrg.use(),this.upsmplPrg.uParams(this._bloomParams);for(let e=s-2;e>=0;e--){let t=e==s-2?this._downFbos[e+1]:this._upFbos[e+1],n=this._downFbos[e],r=this._upFbos[e];r.bind(),r.defaultViewport(),this.upsmplPrg.tInput(n.getColorTexture()),this.upsmplPrg.tInputLowMip(t.getColorTexture()),this.upsmplPrg.uParams(this._bloomParams),this.post.fillScreen(this.upsmplPrg)}}blurHPass(e,t){const n=this.blurHPrg;t.bind(),t.defaultViewport(),n.use(),n.tInput(e.getColorTexture()),n.uTexelSize(1/e.width,1/e.height),this.post.fillScreen(n)}blurVPass(e,t){const n=this.blurVPrg;t.bind(),t.defaultViewport(),n.use(),n.tInput(e.getColorTexture()),n.uTexelSize(1/e.width,1/e.height),this.post.fillScreen(n)}createFbo(e,t){const n=new s.a(this.post.gl);n.attachColor(this.hdrFormat.format,this.hdrFormat.type,this.hdrFormat.internal),n.resize(e,t);const r=n.getColorTexture();return r.bind(),r.setFilter(!0,!1,!1),r.clamp(),n}releaseFbos(){for(const e of this._downFbos)e.dispose();for(const e of this._upFbos)e.dispose();this._downFbos.length=0,this._upFbos.length=0}}},244:function(e,t){var n=function(e){return"\n#define DECODE_HDR(k) k.rgb\n#define ENCODE_HDR(k) vec4(k,1.0)","\n#define DECODE_HDR(k) k.rgb\n#define ENCODE_HDR(k) vec4(k,1.0)"};n.toString=n,e.exports=n},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(352),s=n.n(r),i=n(353),a=n.n(i),o=n(77),l=n(76),c=n(41);const u=new Float32Array([0,0,1,0,0,1,1,1]);class h{constructor(e){this.fbo=new o.a(e),this.fbo.attachColor(e.RGB,e.UNSIGNED_BYTE),this.fbo.resize(4,4),this.fbo.getColorTexture().clamp(),this.fbo.getColorTexture().setFilter(!1,!1,!1),this.prg=new l.a(e,a()(),s()()),this.fsPlane=new c.a(e,u),this.fsPlane.attrib("aTexCoord0",2,e.FLOAT)}resize(e,t){this.fbo.resize(e,t)}render(){this.prg.use(),this.prg.uTexelSize(1/this.fbo.width,1/this.fbo.height),this.prg.tInput(this.fbo.getColorTexture()),this.fsPlane.attribPointer(this.prg),this.fsPlane.drawTriangleStrip()}}},257:function(e,t,n){"use strict";class r{constructor(e,t){this.uid=t,this.lib=e,this.matlist=[],this.materials={}}registerMaterial(e,t){void 0===this.materials[t]&&(this.materials[t]=e,this.matlist.push(e),this.lib.registerMaterial(e,this.uid+"/"+t))}get(e){return this.materials[e]||this.lib.get(e)}dispose(){}}var s=n(28);function i(e){const t=new s.a,n=e.concat();return function r(){for(var s=0;n.length>0&&s<1;){n.pop().getProgram(),s++}0===n.length?t.resolve(e):window.requestAnimationFrame(r)}(),t.promise}function a(e){const t=new s.a,n=e.concat();return function r(){for(var s=0;n.length>0&&s<1;){var i=n.pop().getProgram();i.ready||(i.use(),s++)}0===n.length?t.resolve(e):window.requestAnimationFrame(r)}(),t.promise}var o=n(217);const l=n(308);function c(){}t.a=class{constructor(e){this.scene=e,this.gl=e.gl,this.materials={},this.matlist=[],this.defaultMaterial=null}dummy(){return{compile:c,prg:{use:c}}}dispose(){this.gl=null,this.scene=null,this.materials=null,this.matlist=null,this.defaultMaterial=null}createProvider(e){return new r(this,e)}registerMaterial(e,t){void 0===this.materials[t]&&(this.materials[t]=e,e.name=t,this.matlist.push(e))}get(e){var t=this.materials[e];return void 0===t&&(console.log("        -> not found",e),t=this.defaultMaterial),t}compileAllAsync(){return function(e){const t=[];return function(e,t){const n=e.length;for(let r=0;r<n;r++)t.push(...e[r].getAllPasses())}(e=e.concat(),t),Promise.resolve(t).then(i).then(a)}(this.matlist)}compileAll(){this.matlist.forEach(e=>{e.getPass(o.a.DEFAULT).getProgram().use()});var e=new l(this.gl);return e.insert(),e.promise}}},268:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(27),s=n(2),i=n(295);class a extends r.a{constructor(){super(...arguments),this.gltftype=s.a.NODE,this.weights=null}async parse(e,t){var n,r;if(this.extras=t.extras,void 0!==t.camera&&(this.camera=await e.getElement(s.a.CAMERA,t.camera)),void 0!==t.matrix&&this.setMatrix(new Float32Array(t.matrix)),void 0!==t.scale&&this.scale.set(t.scale),void 0!==t.translation&&this.position.set(t.translation),void 0!==t.rotation&&this.rotation.set(t.rotation),void 0!==t.children){const n=t.children.map(t=>e.getElement(s.a.NODE,t)),r=await Promise.all(n);for(var i of r)this.add(i)}if(void 0!==t.skin&&(this.skin=await e.getElement(s.a.SKIN,t.skin)),void 0!==t.mesh){this.mesh=await e.getElement(s.a.MESH,t.mesh);const n=this.mesh.primitives[0].targets;n&&(this.weights=new Float32Array(n.length))}if(void 0!==t.weights){if(null===this.weights||this.weights.length!==t.weights.length)throw new Error("morph weights on node doesn't match mesh targets");this.weights.set(t.weights)}this.name=null!==(n=t.name)&&void 0!==n?n:null===(r=this.mesh)||void 0===r?void 0:r.name,this.invalidate()}findChild(e){for(let t=0;t<this._children.length;t++){const n=this._children[t];if(n.name===e)return n}}findDescendant(e){var t;let n=this.findChild(e);if(void 0===n)for(let r=0;r<this._children.length;r++){const s=this._children[r];if(n=null===(t=s.findDescendant)||void 0===t?void 0:t.call(s,e),void 0!==n)return n}return n}allocateGl(e){this.mesh&&(this.renderable=new i.a(e,this))}}},269:function(e,t,n){"use strict";t.a=["D_RGB","D_DEPTH"]},295:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var r=n(26),s=n(1),i=n(315),a=n.n(i),o=n(316),l=n.n(o),c=n(269),u=n(43),h=n(42);const p=s.mat4.create();class m extends h.a{constructor(e){super({uid:"stddepth",vert:a()(),frag:l()()}),this.depthFormat=this.inputs.add(new r.a("depthFormat",c.a)),this.precision=this.inputs.add(new u.a("highp"))}setLightSetup(e){this.depthFormat.proxy(null==e?void 0:e.depthFormat)}prepare(e,t,n){e.uMVP&&(n.modelViewProjectionMatrix(p,t._wmatrix),e.uMVP(p)),e.uWorldMatrix&&e.uWorldMatrix(t._wmatrix),e.uVP&&e.uVP(n._viewProj)}}var d=n(7);function f(e){return e.attributes.map((t,n)=>`IN ${e.type} ${t};`).join("\n")}function g(e){const t=e.attributes.map((e,t)=>`${e} * uMorphWeights[${t}]`).join(" +\n ");return`void MorphAttribute_${e.name}( inout ${e.type} ${e.name} ){\n    ${e.name} += ${t};\n  }`}function v(e){return`MorphAttribute_${e.name}( vertex.${e.name} );`}function E(e){return e.map(g).join("\n")}var _={preVertexCode(e){return[(n=e.numTargets,`uniform float uMorphWeights[${n}];`),(t=e.morphInfos,t.map(f).join("\n")),E(e.morphInfos)].join("\n");var t,n},vertexCode:e=>e.morphInfos.map(v).join("\n")};class w extends d.a{constructor(e){super(!0,!0),this._morphInfos=[],function(e){const t=e[0].attributes.length;for(let n=1;n<e.length;n++)if(e[n].attributes.length!==t)throw new Error("MorphDeformer mutiple morph dont have the same size")}(e),this._morphInfos=e,this._weights=new Float32Array(this.numTargets)}get weights(){return this._weights}set weights(e){if(e.length!==this.numTargets)throw new Error("MorphDeformer weights length and numMorph must match");this._weights=e}get numTargets(){return this._morphInfos[0].attributes.length}get morphInfos(){return this._morphInfos}setup(e){e.uMorphWeights(this._weights)}_genCode(e){e.add("pv",_.preVertexCode(this)),e.add("vertex_warp",_.vertexCode(this))}_getHash(){return"mrph"}}var x=n(317),A=n.n(x);const y=["x","y","z","w"];function S(e){let t="";for(const r of e){const e=1===(n=r.numComponents)?"float":"vec"+n;t+=`\nIN ${e} ${r.jointsAttrib}; \nIN ${e} ${r.weightsAttrib};`}var n;return t}function T(e){const t=[];for(const n of e){const e=n.numComponents;for(let r=0;r<e;r++){const s=1===e?"":"."+y[r],i=n.jointsAttrib+s,a=n.weightsAttrib+s;t.push(`uJoints[int(${i})] * ${a}`)}}return t.join("+ \n  ")}var b={preVertexCode:e=>A()({pv:!0,numJoints:e._numJoints,attribDecl:S(e._attributeSets),matrixSum:T(e._attributeSets)}),vertexCode:()=>A()({vertex_warp:!0})};class C extends d.a{constructor(e,t){super(!0,!0),this._attributeSets=t,this._numJoints=e,this._jointsBuffer=new Float32Array(16*this._numJoints),this._jointMatrices=[];const n=this._jointsBuffer.buffer;for(let e=0;e<this._numJoints;e++)this._jointMatrices.push(new Float32Array(n,16*e*4,16))}get numJoints(){return this._numJoints}get jointMatrices(){return this._jointMatrices}setup(e){e.uJoints(this._jointsBuffer)}_genCode(e){e.add("pv",b.preVertexCode(this)),e.add("vertex_warp",b.vertexCode())}}var R=n(71),P=n(89);function I(e){if(e<1||e>4)throw new Error("number is not Component size")}function D(e){if("position"!==e&&"normal"!==e&&"tangent"!==e)throw new Error(`semantic ${e} can't be morphed`)}class M{constructor(e,t){this.materials=[],this.bounds=new P.a,R.a.isDefined(t.mesh),this.node=t,this.mesh=t.mesh,this.setupMaterials(e),this.computeBounds()}setupMaterials(e){for(const t of this.mesh.primitives){const n=t.material.createMaterialForPrimitive(e,this.node,t),r=new m(e);r.depthFormat.set("D_DEPTH"),n.addPass(r,"depth"),this.configureDeformers(n,t),this.materials.push(n)}}configureDeformers(e,t){this.configureSkin(e,t),this.configureMorph(e,t)}configureMorph(e,t){if(null!==t.targets){const n=t.targets[0].attributes,r=[];for(const e of n){const n=t.targets.map(t=>t.getSemantic(e.semantic).glslname),s=e.semantic.toLowerCase();D(s);const i={name:s,type:e.accessor.glslType,attributes:n};r.push(i)}const s=new w(r);e.inputs.add(s),this._morph=s,this.setupMorphWeights()}}setupMorphWeights(){this.node.weights?this._morph.weights=this.node.weights:this.mesh.weights&&(this._morph.weights=this.mesh.weights)}configureSkin(e,t){if(this.node.skin){const n=this.node.skin.joints.length,r=[];let s=0;for(;;){const e="WEIGHTS_"+s,n="JOINTS_"+s,i=t.attributes.getSemantic(e),a=t.attributes.getSemantic(n);if(null===i!=(null===a))throw new Error("Skin attributes inconsistency");if(null===i)break;if(i.accessor.numComps!==a.accessor.numComps)throw new Error("weight and joints attribute dont have the same size");const o=i.accessor.numComps;I(o),r.push({weightsAttrib:i.glslname,jointsAttrib:a.glslname,numComponents:o}),s++}const i=new C(n,r);e.inputs.add(i),this._skin=i}}computeBounds(){this.bounds.copyFrom(this.mesh.primitives[0].bounds);for(const e of this.mesh.primitives)P.a.union(this.bounds,this.bounds,e.bounds)}render(e,t,n,r,s){const i=e.glstate,a=this.mesh.primitives;this._skin&&this.node.skin.computeJoints(this.node,this._skin.jointMatrices),this._morph&&this.setupMorphWeights();for(let e=0;e<a.length;e++){const o=a[e],l=this.materials[e];if(!l.hasPass(r)||0==(l.mask&n))continue;const c=l.getPass(r);0!=(c.pass.mask&n)&&(c.prepare(this.node,t),i.push(c.pass.glconfig),l.glconfig&&i.push(l.glconfig),this.glconfig&&i.push(this.glconfig),s&&i.push(s),i.apply(),this.drawCall(t,c.getProgram(),o),i.pop(),l.glconfig&&i.pop(),this.glconfig&&i.pop(),s&&i.pop())}}drawCall(e,t,n){n.bindVao(t),n.render(),n.unbindVao()}}},308:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));class r{constructor(e){this.gl=e,this._sync=null,this._invalidated=!1,this._pooled=!1,this.promise=new Promise((e,t)=>{this._defer={resolve:e,reject:t}})}insert(){var e;null!==this._sync||this._invalidated||(this._sync=function(e){return void 0!==e.fenceSync}(e=this.gl)?new s(e):new i,this._pool())}dispose(){this._release()}isSignaled(){return null!==this._sync&&this._sync.isSignaled()}then(e,t){this.promise.then(e,t)}clientWaitSync(e=1e6){return null===this._sync?37149:this._sync.clientWaitSync(e)}_release(){this._defer.reject(null),this._unpool(),this._invalidated=!0,null!==this._sync&&(this._sync.dispose(),this._sync=null)}_complete(){this._defer.resolve(),this._release()}_pool(){this._pooled||(a.push(this),this._pooled=!0)}_unpool(){this._pooled&&(a.splice(a.indexOf(this),1),this._pooled=!1)}}r.resolve=c,r.auto=function(e){void 0===e&&(e=32);l(),o=setInterval(c,e)},r.stop=l;class s{constructor(e){this.gl=e,this.sync=e.fenceSync(37143,0),e.flush()}isSignaled(){return 37145===this.gl.getSyncParameter(this.sync,37140)}dispose(){this.gl.deleteSync(this.sync)}clientWaitSync(e){return this.gl.clientWaitSync(this.sync,this.gl.SYNC_FLUSH_COMMANDS_BIT,e)}}class i{isSignaled(){return!0}dispose(){}clientWaitSync(e){return 37146}}const a=[];let o;function l(){clearInterval(o)}function c(){for(var e=a.length-1;e>=0;e--)a[e].isSignaled()&&a[e]._complete()}},314:function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],o=r[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,o)),u=0,h=o>0?a-4:a;for(n=0;n<h;n+=4)t=s[e.charCodeAt(n)]<<18|s[e.charCodeAt(n+1)]<<12|s[e.charCodeAt(n+2)]<<6|s[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===o&&(t=s[e.charCodeAt(n)]<<2|s[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===o&&(t=s[e.charCodeAt(n)]<<10|s[e.charCodeAt(n+1)]<<4|s[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,s=n%3,i=[],a=0,o=n-s;a<o;a+=16383)i.push(u(e,a,a+16383>o?o:a+16383));1===s?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===s&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],s=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var s,i,a=[],o=t;o<n;o+=3)s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(r[(i=s)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},315:function(e,t,n){var r=function(e){var t="";return t+="\n#pragma SLOT version\n\n#pragma SLOT definitions\n\n\n#ifndef hasNormals\n  #define hasNormals 1\n#endif \n#ifndef hasTangents\n  #define hasTangents hasNormals\n#endif \n\n#if hasTangents && !hasNormals \n  #pragma error tan but no nrm\n  error\n#endif\n\n#pragma SLOT precision\n\n"+n(75)()+"\n\n#pragma SLOT pv\n\n\nIN vec3 aPosition;\n\n\n// uniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\nuniform mat4 uVP;\n\n\n#if depthFormat( D_RGB )\n  OUT vec2 fragZW;\n#endif\n\n\nstruct VertexData {\n  highp vec3 position;\n  highp vec3 worldPos;\n  #if hasNormals\n    vec3 normal;\n  #endif\n  #if hasTangents\n    vec3 tangent;\n  #endif\n  mat4 worldMatrix;\n};\n\n\nvoid InitVertexData( out VertexData vertex ){\n\n  vertex.position = aPosition;\n  #if hasNormals\n    vertex.normal = vec3(0.0);\n  #endif\n  #if hasTangents\n    vertex.tangent = vec3(0.0);\n  #endif\n\n  vertex.worldMatrix = uWorldMatrix;\n   \n}\n\n\n\nvoid main( void ){\n\n  #pragma SLOT v\n\n  VertexData vertex;\n  InitVertexData( vertex );\n\n  #pragma SLOT vertex_warp\n\n  vec4 worldPos = vertex.worldMatrix * vec4( vertex.position, 1.0 );\n  vertex.worldPos.xyz = worldPos.xyz / worldPos.w;\n\n  #pragma SLOT vertex_warp_world\n\n  gl_Position     = uVP * vec4( vertex.worldPos, 1.0 );\n\n  #if depthFormat( D_RGB )\n    fragZW=gl_Position.zw;\n  #endif\n\n}\n"};r.toString=r,e.exports=r},316:function(e,t,n){var r=function(e){var t="";return t+="#pragma SLOT version\n\n#pragma SLOT definitions\n\n#pragma SLOT precision\n\n"+n(74)()+"\n\n#pragma SLOT pf\n\n\n#if depthFormat( D_RGB )\n  IN vec2 fragZW;\n\n  vec3 encodeDepthRGB(float depth){\n    vec4 c = vec4(1.0,255.0,65025.0,16581375.0)*depth;\n    c=fract(c);\n    c.xyz-=c.yzw*(1.0/255.0);\n    return c.xyz;\n  }\n#endif\n\n\n\nvoid main(void){\n\n  #if depthFormat( D_RGB )\n    gl_FragColor.xyz = encodeDepthRGB( ( fragZW.x / fragZW.y ) * 0.5 + 0.5 );\n    gl_FragColor.w=0.0;\n  #endif\n\n  #if depthFormat( D_DEPTH )\n    gl_FragColor = vec4( 0.0 );\n  #endif\n\n}\n"};r.toString=r,e.exports=r},317:function(e,t){var n=function(e){var t="";return t+="",!0===e.pv&&(t+="\n\n#define SKIN_NUM_JOINTS "+e.numJoints+"\nuniform mat4 uJoints[SKIN_NUM_JOINTS];\n"+e.attribDecl+"\nmat4 ComputeSkinMatrix() {\n  mat4 SM = "+e.matrixSum+";\n  return SM;\n}\n"),t+="\n\n",!0===e.vertex_warp&&(t+="\n  mat4 _skinMatrix = ComputeSkinMatrix();\n  vertex.worldMatrix = vertex.worldMatrix * _skinMatrix;\n"),t+="\n"};n.toString=n,e.exports=n},318:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=new WeakMap,s=new WeakMap,i=function(){function e(){this.onabort=null,r.set(this,[]),s.set(this,!1)}return Object.defineProperty(e.prototype,"aborted",{get:function(){if(!s.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return s.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"none",{get:function(){return new e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){if(!r.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");r.get(this).push(t)},e.prototype.removeEventListener=function(e,t){if(!r.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");var n=r.get(this),s=n.indexOf(t);s>-1&&n.splice(s,1)},e.prototype.dispatchEvent=function(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")},e}();function a(e){if(!e.aborted){e.onabort&&e.onabort.call(e);var t=r.get(e);t&&t.forEach((function(t){t.call(e,{type:"abort"})})),s.set(e,!0)}}},345:function(e,t){var n=function(e){return"uniform vec3 uBloomColor;\nuniform sampler2D tBloom;","uniform vec3 uBloomColor;\nuniform sampler2D tBloom;"};n.toString=n,e.exports=n},346:function(e,t){var n=function(e){return"c += uBloomColor * texture2D(tBloom,texCoordFull).xyz;","c += uBloomColor * texture2D(tBloom,texCoordFull).xyz;"};n.toString=n,e.exports=n},347:function(e,t,n){var r=function(e){var t="";return t+="\nprecision mediump float;\n\n"+n(74)()+"\n"+n(244)()+"\n\nuniform sampler2D tInput;\nuniform vec2 uTexelSize;\nIN vec2 vTexCoordVP;\n\n\nvoid main(void)\n{\n    float texelSize = uTexelSize.x * 2.0;\n    vec2 uv = vTexCoordVP;\n\n    // 9-tap gaussian blur on the downsampled source\n    vec3 c0 = DECODE_HDR(texture2D(tInput, uv - vec2(texelSize * 4.0, 0.0)));\n    vec3 c1 = DECODE_HDR(texture2D(tInput, uv - vec2(texelSize * 3.0, 0.0)));\n    vec3 c2 = DECODE_HDR(texture2D(tInput, uv - vec2(texelSize * 2.0, 0.0)));\n    vec3 c3 = DECODE_HDR(texture2D(tInput, uv - vec2(texelSize * 1.0, 0.0)));\n    vec3 c4 = DECODE_HDR(texture2D(tInput, uv                             ));\n    vec3 c5 = DECODE_HDR(texture2D(tInput, uv + vec2(texelSize * 1.0, 0.0)));\n    vec3 c6 = DECODE_HDR(texture2D(tInput, uv + vec2(texelSize * 2.0, 0.0)));\n    vec3 c7 = DECODE_HDR(texture2D(tInput, uv + vec2(texelSize * 3.0, 0.0)));\n    vec3 c8 = DECODE_HDR(texture2D(tInput, uv + vec2(texelSize * 4.0, 0.0)));\n\n    vec3 color = c0 * 0.01621622 + c1 * 0.05405405 + c2 * 0.12162162 + c3 * 0.19459459\n                + c4 * 0.22702703\n                + c5 * 0.19459459 + c6 * 0.12162162 + c7 * 0.05405405 + c8 * 0.01621622;\n\n    FragColor = ENCODE_HDR(color);\n\n}"};r.toString=r,e.exports=r},348:function(e,t,n){var r=function(e){var t="";return t+="\nprecision mediump float;\n\n"+n(74)()+"\n"+n(244)()+"\n\nuniform sampler2D tInput;\nuniform vec2 uTexelSize;\nIN vec2 vTexCoordVP;\n\nvoid main(void)\n{\n\n    float texelSize = uTexelSize.y;\n    vec2 uv = vTexCoordVP;\n\n    // Optimized bilinear 5-tap gaussian on the same-sized source (9-tap equivalent)\n    vec3 c0 = DECODE_HDR(texture2D(tInput, uv - vec2(0.0, texelSize * 3.23076923)));\n    vec3 c1 = DECODE_HDR(texture2D(tInput, uv - vec2(0.0, texelSize * 1.38461538)));\n    vec3 c2 = DECODE_HDR(texture2D(tInput, uv                                      ));\n    vec3 c3 = DECODE_HDR(texture2D(tInput, uv + vec2(0.0, texelSize * 1.38461538)));\n    vec3 c4 = DECODE_HDR(texture2D(tInput, uv + vec2(0.0, texelSize * 3.23076923)));\n\n    vec3 color = c0 * 0.07027027 + c1 * 0.31621622\n                + c2 * 0.22702703\n                + c3 * 0.31621622 + c4 * 0.07027027;\n\n    FragColor = ENCODE_HDR(color);\n\n}"};r.toString=r,e.exports=r},349:function(e,t,n){var r=function(e){var t="";return t+="\nprecision mediump float;\n\n"+n(74)()+"\n"+n(244)()+"\n\nuniform sampler2D tInput;\nuniform vec4 uParams;\nIN vec2 vTexCoordVP;\n\n#define ClampMax            uParams.y\n#define Threshold           uParams.z\n#define ThresholdKnee       uParams.w\n\n\nvoid main(void)\n{\n   \n    vec3 color = texture2D(tInput, vTexCoordVP).xyz;\n\n    color = min(vec3(ClampMax), color);\n\n    float brightness = max(color.r, max(color.g, color.b));\n    float softness = clamp(brightness - Threshold + ThresholdKnee, 0.0, 2.0 * ThresholdKnee);\n    softness = (softness * softness) / (4.0 * ThresholdKnee + 1e-4);\n    float multiplier = max(brightness - Threshold, softness) / max(brightness, 1e-4);\n    color *= multiplier;\n\n    FragColor = ENCODE_HDR(color);\n\n}"};r.toString=r,e.exports=r},350:function(e,t,n){var r=function(e){var t="";return t+="\nprecision mediump float;\n\n"+n(74)()+"\n"+n(244)()+"\n\nuniform sampler2D tInput;\nuniform sampler2D tInputLowMip;\nuniform vec4 uParams;\nIN vec2 vTexCoordVP;\n\n#define Scatter uParams.x\n\nvoid main(void)\n{\n    vec3 highMip = DECODE_HDR(texture2D(tInput, vTexCoordVP));\n    vec3 lowMip  = DECODE_HDR(texture2D(tInputLowMip, vTexCoordVP));\n    vec3 color = mix(highMip, lowMip, Scatter);\n    FragColor = ENCODE_HDR(color);\n}"};r.toString=r,e.exports=r},351:function(e,t,n){var r=function(e){var t="";return t+="precision highp float;\n\n\n"+n(75)()+"\n\nIN vec2 aTexCoord0;\n\nOUT vec2 vTexCoordVP;\nOUT vec2 vTexCoordFull;\n\nuniform vec2 uViewportScale;\n\nvoid main(void)\n{\n  vTexCoordVP   = aTexCoord0 * uViewportScale;\n  vTexCoordFull = aTexCoord0;\n\n  gl_Position.xy = 2.0 * aTexCoord0-vec2(1.0,1.0);\n  gl_Position.zw = vec2(0.0,1.0);\n}\n"};r.toString=r,e.exports=r},352:function(e,t){var n=function(e){return"precision mediump float;\n\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n\n\nuniform vec2 uTexelSize;\nuniform sampler2D tInput;\n\nIN vec2 vTexCoord;\n\n\n#define LUMA(k) dot(k, vec3(0.299, 0.587, 0.114))\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 uvs, vec2 texelSize) {\n\n    vec4 color;\n    \n    vec3 rgbNW = texture2D(tex, uvs + texelSize*vec2(-1.0, -1.0) ).xyz;\n    vec3 rgbNE = texture2D(tex, uvs + texelSize*vec2( 1.0, -1.0) ).xyz;\n    vec3 rgbSW = texture2D(tex, uvs + texelSize*vec2(-1.0,  1.0) ).xyz;\n    vec3 rgbSE = texture2D(tex, uvs + texelSize*vec2( 1.0,  1.0) ).xyz;\n    vec4 texColor = texture2D(tex, uvs);\n    vec3 rgbM  = texColor.xyz;\n\n    float lumaNW = LUMA( rgbNW );\n    float lumaNE = LUMA( rgbNE );\n    float lumaSW = LUMA( rgbSW );\n    float lumaSE = LUMA( rgbSE );\n    float lumaM  = LUMA( rgbM );\n    \n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * texelSize;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, uvs + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, uvs + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, uvs + dir * -0.5).xyz +\n        texture2D(tex, uvs + dir * 0.5).xyz);\n\n    float lumaB = LUMA(rgbB);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, 1.0);\n    else\n        color = vec4(rgbB, 1.0);\n    return color;\n}\n\n\nvoid main( void ){\n    FragColor = fxaa( tInput, vTexCoord, uTexelSize );\n    // FragColor =  texture2D( tInput, vTexCoord);\n}\n","precision mediump float;\n\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n\n\nuniform vec2 uTexelSize;\nuniform sampler2D tInput;\n\nIN vec2 vTexCoord;\n\n\n#define LUMA(k) dot(k, vec3(0.299, 0.587, 0.114))\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 uvs, vec2 texelSize) {\n\n    vec4 color;\n    \n    vec3 rgbNW = texture2D(tex, uvs + texelSize*vec2(-1.0, -1.0) ).xyz;\n    vec3 rgbNE = texture2D(tex, uvs + texelSize*vec2( 1.0, -1.0) ).xyz;\n    vec3 rgbSW = texture2D(tex, uvs + texelSize*vec2(-1.0,  1.0) ).xyz;\n    vec3 rgbSE = texture2D(tex, uvs + texelSize*vec2( 1.0,  1.0) ).xyz;\n    vec4 texColor = texture2D(tex, uvs);\n    vec3 rgbM  = texColor.xyz;\n\n    float lumaNW = LUMA( rgbNW );\n    float lumaNE = LUMA( rgbNE );\n    float lumaSW = LUMA( rgbSW );\n    float lumaSE = LUMA( rgbSE );\n    float lumaM  = LUMA( rgbM );\n    \n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * texelSize;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, uvs + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, uvs + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, uvs + dir * -0.5).xyz +\n        texture2D(tex, uvs + dir * 0.5).xyz);\n\n    float lumaB = LUMA(rgbB);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, 1.0);\n    else\n        color = vec4(rgbB, 1.0);\n    return color;\n}\n\n\nvoid main( void ){\n    FragColor = fxaa( tInput, vTexCoord, uTexelSize );\n    // FragColor =  texture2D( tInput, vTexCoord);\n}\n"};n.toString=n,e.exports=n},353:function(e,t){var n=function(e){return"precision highp float;\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n\nIN vec2 aTexCoord0;\nOUT vec2 vTexCoord;\n\n\nvoid main(void)\n{\n  vTexCoord = aTexCoord0;\n  gl_Position.xy = 2.0 * aTexCoord0-vec2(1.0,1.0);\n  gl_Position.zw = vec2(0.0,1.0);\n}\n","precision highp float;\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n\nIN vec2 aTexCoord0;\nOUT vec2 vTexCoord;\n\n\nvoid main(void)\n{\n  vTexCoord = aTexCoord0;\n  gl_Position.xy = 2.0 * aTexCoord0-vec2(1.0,1.0);\n  gl_Position.zw = vec2(0.0,1.0);\n}\n"};n.toString=n,e.exports=n}}]);